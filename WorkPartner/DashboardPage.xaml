<UserControl x:Class="WorkPartner.DashboardPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:WorkPartner"
             mc:Ignorable="d" 
             d:DesignHeight="650" d:DesignWidth="1000"
             Loaded="Window_Loaded" IsVisibleChanged="DashboardPage_IsVisibleChanged">
    
    <UserControl.Resources>
    </UserControl.Resources>
    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="1.5*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        

        <Border Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Style="{StaticResource SectionBorderStyle}" Margin="5">
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="19, 40, 0, 0">
                    <Button Tag="Analysis" Click="NavButton_Click" ToolTip="분석" Margin="5"
                            Width="24" Height="24" Background="Transparent" BorderBrush="Transparent">
                        <Image Source="/images/bar_chart.png" />
                    </Button>
                    <Button Tag="Settings" Click="NavButton_Click" ToolTip="설정"
                            Width="24" Height="24" Background="Transparent" BorderBrush="Transparent">
                        <Image Source="/images/settings.png" />
                    </Button>
                </StackPanel>

                <StackPanel Margin="20" VerticalAlignment="Center">
                    <TextBlock Text="오늘의 학습 시간" FontFamily="./Fonts/#Freesentation" TextAlignment="Center" FontSize="14" Foreground="#FF005B8B" FontWeight="Bold"/>
                    <TextBlock x:Name="MainTimeDisplay" FontFamily="./Fonts/#Freesentation" Text="00:00:00" TextAlignment="Center" FontSize="40" FontWeight="Bold" Margin="0,5,0,10"/>
                    <TextBlock x:Name="SelectedTaskTotalTimeDisplay" FontFamily="./Fonts/#Freesentation" Text="오늘의 작업 시간 | 00:00:00" TextAlignment="Center" FontSize="8" Foreground="Gray"/>
                </StackPanel>
            </Grid>
        </Border>

        <Border Grid.Row="1" Grid.Column="0" Grid.RowSpan="2" Style="{StaticResource SectionBorderStyle}" Margin="5">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="10">
                    <Button Content="&lt;" Click="PrevDayButton_Click" Margin="0,0,5,0"/>
                    <Button Content="오늘" Click="TodayButton_Click"/>
                    <Button Content="&gt;" Click="NextDayButton_Click" Margin="5,0,0,0"/>
                    <DatePicker x:Name="TimelineDatePicker" SelectedDateChanged="TimelineDatePicker_SelectedDateChanged" Margin="10,0,0,0"/>
                </StackPanel>
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                    <Canvas x:Name="SelectionCanvas" Background="Transparent" 
                            MouseLeftButtonDown="SelectionCanvas_MouseLeftButtonDown"
                            MouseMove="SelectionCanvas_MouseMove" 
                            MouseLeftButtonUp="SelectionCanvas_MouseLeftButtonUp">
                        <StackPanel x:Name="TimeTableContainer" Orientation="Vertical"/>
                    </Canvas>
                </ScrollViewer>
            </DockPanel>
        </Border>

        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource SectionBorderStyle}" Padding="15" Margin="5">
            <StackPanel>
                <TextBlock Text="메모" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,10"/>
                <Button Content="메모장 열기" Click="MemoButton_Click" Style="{StaticResource ActionButtonStyle}"/>
            </StackPanel>
        </Border>

        <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource SectionBorderStyle}" Padding="15" Margin="5">
            <StackPanel>
                <TextBlock Text="백색소음" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,10"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="파도" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Slider Grid.Row="0" Grid.Column="1" Minimum="0" Maximum="1" Value="0" ValueChanged="SoundSlider_ValueChanged" Tag="wave"/>
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="숲" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Slider Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="1" Value="0" ValueChanged="SoundSlider_ValueChanged" Tag="forest"/>
                    <TextBlock Grid.Row="2" Grid.Column="0" Text="비" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Slider Grid.Row="2" Grid.Column="1" Minimum="0" Maximum="1" Value="0" ValueChanged="SoundSlider_ValueChanged" Tag="rain"/>
                    <TextBlock Grid.Row="3" Grid.Column="0" Text="불" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <Slider Grid.Row="3" Grid.Column="1" Minimum="0" Maximum="1" Value="0" ValueChanged="SoundSlider_ValueChanged" Tag="campfire"/>
                </Grid>
            </StackPanel>
        </Border>

        <Border Grid.Row="0" Grid.Column="2" Style="{StaticResource SectionBorderStyle}" Padding="15" Margin="5">
            <StackPanel>
                <TextBlock Text="내 캐릭터" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,10"/>
                <local:CharacterDisplay x:Name="CharacterPreview" Height="100"/>
                <Grid Margin="0,10,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock x:Name="UsernameDisplay" Grid.Column="0" Text="사용자" FontWeight="Bold" VerticalAlignment="Center" FontSize="16"/>
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Image Source="/images/coin.png" Width="16" Height="16" VerticalAlignment="Center"/>
                        <TextBlock x:Name="CoinDisplay" Text="0" VerticalAlignment="Center" Margin="5,0,0,0"/>
                    </StackPanel>
                </Grid>
                <TextBlock x:Name="CurrentTaskDisplay" Text="휴식 중" Foreground="Gray" FontSize="12" Margin="0,0,0,10"/>
                <Button Content="아바타 꾸미기" Style="{StaticResource ActionButtonStyle}" Click="GoToClosetButton_Click"/>
            </StackPanel>
        </Border>

        <Border Grid.Row="1" Grid.Column="2" Style="{StaticResource SectionBorderStyle}" Margin="5">
            <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="과목 관리" Style="{StaticResource SectionHeaderStyle}" Margin="15,15,15,5"/>
                <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" Margin="10">
                    <TextBox x:Name="TaskInput" KeyDown="TaskInput_KeyDown" Style="{StaticResource InputTextBoxStyle}" HorizontalAlignment="Stretch" Width="150"/>
                    <Button Content="추가" Click="AddTaskButton_Click" Margin="5,0,0,0"/>
                </StackPanel>
                <ListBox x:Name="TaskListBox" ItemsSource="{Binding TaskItems}" SelectionChanged="TaskListBox_SelectionChanged"
                         ScrollViewer.VerticalScrollBarVisibility="Auto" Margin="10,0,10,10">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Text}"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </DockPanel>
        </Border>

        <Border Grid.Row="2" Grid.Column="2" Style="{StaticResource SectionBorderStyle}" Padding="15" Margin="5">
            <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="오늘의 할일" Style="{StaticResource SectionHeaderStyle}" Margin="0,0,0,10"/>
                <StackPanel DockPanel.Dock="Bottom" Margin="0,10,0,0">
                    <TextBox x:Name="TodoInput" KeyDown="TodoInput_KeyDown" Style="{StaticResource InputTextBoxStyle}"/>
                    <Button Content="할일 추가" Click="AddTodoButton_Click" Margin="0,5,0,0"/>
                </StackPanel>
                <TreeView x:Name="TodoTreeView" ItemsSource="{Binding FilteredTodoItems}" PreviewMouseLeftButtonDown="TodoTreeView_PreviewMouseLeftButtonDown"
                          ScrollViewer.VerticalScrollBarVisibility="Auto">
                </TreeView>
            </DockPanel>
        </Border>

        <Border x:Name="SessionReviewPanel" Visibility="Collapsed" Background="#AA000000" Grid.ColumnSpan="3" Grid.RowSpan="3">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="방금 세션은 얼마나 집중했나요?" Foreground="White" FontSize="18" TextAlignment="Center" Margin="10"/>
                <StackPanel Orientation="Horizontal">
                    <Button Content="1점" Tag="1" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="2점" Tag="2" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="3점" Tag="3" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="4점" Tag="4" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="5점" Tag="5" Click="RateSessionButton_Click" Margin="5"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <TextBlock x:Name="AiSuggestionTextBlock" Text="" Foreground="DodgerBlue" Grid.Column="1" VerticalAlignment="Bottom" Margin="10"/>
    </Grid>
</UserControl>