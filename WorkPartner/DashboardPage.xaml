<UserControl x:Class="WorkPartner.DashboardPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://expression.blend.com/2008" 
             xmlns:local="clr-namespace:WorkPartner"
             mc:Ignorable="d" 
             d:DesignHeight="526" d:DesignWidth="682"
             Loaded="Window_Loaded" IsVisibleChanged="DashboardPage_IsVisibleChanged"
             FontFamily="Pretendard">

    <Canvas x:Name="dashboard" Width="682" Height="526" Background="#FFFFFF">

        <Button Canvas.Left="19" Canvas.Top="40" Width="24" Height="24" 
                Tag="Settings" Click="NavButton_Click" ToolTip="설정" Background="Transparent" BorderBrush="Transparent">
            <Image Source="/images/settings.png" />
        </Button>

        <Button Canvas.Left="54" Canvas.Top="40" Width="24" Height="24"
                Tag="Analysis" Click="NavButton_Click" ToolTip="분석" Background="Transparent" BorderBrush="Transparent">
            <Image Source="/images/bar_chart.png" />
        </Button>

        <TextBlock x:Name="CurrentTaskDisplay" Canvas.Left="175" Canvas.Top="76" 
                   Text="현재 과목" TextAlignment="Center" Foreground="#FF005B8B"
                   FontFamily="Pretendard" FontSize="14" FontWeight="SemiBold"/>

        <TextBlock x:Name="MainTimeDisplay" Canvas.Left="123" Canvas.Top="92" Width="180"
                   Text="00:00:00" TextAlignment="Center" 
                   FontFamily="Pretendard" FontSize="40" FontWeight="SemiBold"/>

        <TextBlock x:Name="SelectedTaskTotalTimeDisplay" Canvas.Left="159" Canvas.Top="145" 
                   Text="오늘의 작업 시간 | 00:00:00" TextAlignment="Center" 
                   FontFamily="Pretendard" FontSize="8" FontWeight="Medium"/>

        <Border Canvas.Left="19" Canvas.Top="173" Width="388" Height="331" 
                BorderBrush="#f0f0f0" BorderThickness="2" CornerRadius="10">
            <Canvas>
                <Grid Canvas.Left="135" Canvas.Top="11" Width="120" Height="20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0" Content="&lt;" Click="PrevDayButton_Click" VerticalAlignment="Center" Background="Transparent" BorderBrush="Transparent"/>
                    <TextBlock x:Name="CurrentDateDisplay" Grid.Column="1" Text="2025-08-12" VerticalAlignment="Center" FontSize="8" FontFamily= "Pretendard" HorizontalAlignment="Center" Padding= "21, 3, 21, 3" Background="#F0F0F0" FontWeight="SemiBold"/>
                    <Button Grid.Column="2" Content="&gt;" Click="NextDayButton_Click" VerticalAlignment="Center" Background="Transparent" BorderBrush="Transparent"/>
                </Grid>

                <StackPanel Orientation="Horizontal" Canvas.Left="270" Canvas.Top="12">
                    <Button Content="+ 기록 직접 추가" Click="AddManualLogButton_Click" Height="20"/>
                </StackPanel>

                <Border Canvas.Left="23" Canvas.Top="38" Width="239" Height="264" 
                        BorderBrush="Black" BorderThickness="1" CornerRadius="10">
                    <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                        <Canvas x:Name="SelectionCanvas" Background="Transparent" 
                                MouseLeftButtonDown="SelectionCanvas_MouseLeftButtonDown"
                                MouseMove="SelectionCanvas_MouseMove" 
                                MouseLeftButtonUp="SelectionCanvas_MouseLeftButtonUp">
                            <StackPanel x:Name="TimeTableContainer" Orientation="Vertical"/>
                        </Canvas>
                    </ScrollViewer>
                </Border>

                <Border Canvas.Left="272" Canvas.Top="38" Width="95" Height="171" 
                        BorderBrush="Black" BorderThickness="1" CornerRadius="10">
                    <Button Content="메모장" Click="MemoButton_Click" Style="{StaticResource ActionButtonStyle}"/>
                </Border>

                <Border Canvas.Left="272" Canvas.Top="215" Width="95" Height="87" 
                        BorderBrush="Black" BorderThickness="1" CornerRadius="10">
                </Border>
            </Canvas>
        </Border>

        <Border Canvas.Left="417" Canvas.Top="40" Width="247" Height="123" 
                BorderBrush="Black" BorderThickness="1" CornerRadius="10">
            <Grid>
                <local:CharacterDisplay x:Name="CharacterPreview" />
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="10">
                    <TextBlock x:Name="UsernameDisplay" Text="User" FontWeight="Bold" Margin="0,0,10,0"/>
                    <Image Source="/images/coin.png" Width="16" Height="16"/>
                    <TextBlock x:Name="CoinDisplay" Text="0"/>
                </StackPanel>
            </Grid>
        </Border>

        <Border Canvas.Left="417" Canvas.Top="173" Width="247" Height="145" 
                BorderBrush="Black" BorderThickness="1" CornerRadius="10">
            <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="과목 관리"/>
                <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal">
                    <TextBox x:Name="TaskInput" KeyDown="TaskInput_KeyDown" Width="180"/>
                    <Button Content="추가" Click="AddTaskButton_Click"/>
                </StackPanel>
                <ListBox x:Name="TaskListBox" ItemsSource="{Binding TaskItems}" />
            </DockPanel>
        </Border>

        <Border Canvas.Left="417" Canvas.Top="327" Width="247" Height="177" 
                BorderBrush="Black" BorderThickness="1" CornerRadius="10">
            <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="오늘의 할일"/>
                <StackPanel DockPanel.Dock="Bottom">
                    <TextBox x:Name="TodoInput" KeyDown="TodoInput_KeyDown"/>
                    <Button Content="할일 추가" Click="AddTodoButton_Click"/>
                </StackPanel>
                <TreeView x:Name="TodoTreeView" ItemsSource="{Binding FilteredTodoItems}"/>
            </DockPanel>
        </Border>

        <Border x:Name="SessionReviewPanel" Visibility="Collapsed" Background="#AA000000"
                Canvas.Left="0" Canvas.Top="0" Width="682" Height="526">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="방금 세션은 얼마나 집중했나요?" Foreground="White" FontSize="18" TextAlignment="Center" Margin="10"/>
                <StackPanel Orientation="Horizontal">
                    <Button Content="1점" Tag="1" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="2점" Tag="2" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="3점" Tag="3" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="4점" Tag="4" Click="RateSessionButton_Click" Margin="5"/>
                    <Button Content="5점" Tag="5" Click="RateSessionButton_Click" Margin="5"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <TextBlock x:Name="AiSuggestionTextBlock" Text="" Canvas.Left="10" Canvas.Top="500" Visibility="Collapsed"/>

    </Canvas>
</UserControl>